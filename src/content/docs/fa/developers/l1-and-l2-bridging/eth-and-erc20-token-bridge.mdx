---
section: developers
date: Last Modified
title: "بریج توکن‌های ETH و ERC20"
lang: "fa"
dir: "rtl"
permalink: "developers/l1-and-l2-bridging/eth-and-erc20-token-bridge"
whatsnext: { "بریج ERC721 NFT": "/fa/developers/l1-and-l2-bridging/erc721-nft-bridge/" }
excerpt: "Gateway Router امکان بریج ETH و توکن‌های ERC20 از L1 به L2 را با استفاده از توابع depositETH و depositERC20 به ترتیب فراهم می‌کند."
---

import Aside from "../../../../../components/Aside.astro"

## واریز ETH و توکن‌های ERC20 از L1

Gateway Router امکان بریج ETH و توکن‌های ERC20 از L1 به L2 را با استفاده از توابع `depositETH` و `depositERC20` به ترتیب فراهم می‌کند. این یک پل بدون مجوز است که بر روی L1 مستقر شده است. توجه داشته باشید که توکن‌های ERC20 در L2 آدرس متفاوتی خواهند داشت، شما می‌توانید از تابع `getL2ERC20Address` برای پرس‌وجو از آدرس جدید استفاده کنید.

<Aside type="tip" title="">
  **`depositETH`** و **`depositERC20`** توابع پرداختی هستند، مقدار ETH ارسال‌شده به این توابع برای پرداخت هزینه‌های L2 استفاده خواهد شد. اگر مقدار کافی نباشد، تراکنش ارسال نخواهد شد. تمام ETH اضافی به فرستنده برمی‌گردد. `0.00001 ETH` باید برای پردازش واریز توکن کافی باشد.
</Aside>

هنگام بریج توکن‌های ERC20، نیازی به نگرانی در مورد انتخاب Gateway مناسب ندارید. این به این دلیل است که `L1GatewayRouter` نقطه ورودی صحیح را برای ارسال پیام انتخاب خواهد کرد:

- **`L1StandardERC20Gateway`:** این Gateway اجازه می‌دهد هر واریزی از ERC20 انجام شود و به عنوان پیش‌فرض توسط L1GatewayRouter برای توکن‌های ERC20 که نیاز به منطق خاص در L2 ندارند انتخاب خواهد شد. در اولین بریج توکن، توکن جدیدی در L2 ایجاد می‌شود که `ScrollStandardERC20` را پیاده‌سازی می‌کند. برای بریج یک توکن، تابع `depositERC20` را بر روی `L1GatewayRouter` فراخوانی کنید.
- **`L1CustomERC20Gateway`:** این Gateway توسط `L1GatewayRouter` برای توکن‌هایی با منطق خاص انتخاب خواهد شد. برای اینکه یک جفت توکن L1/L2 در بریج سفارشی ERC20 Scroll کار کند، قرارداد توکن L2 باید `IScrollStandardERC20` را پیاده‌سازی کند. علاوه بر این، توکن باید به `L2CustomERC20Gateway` مجوز `mint` یا `burn` را اعطا کند. برای یک مثال مرحله به مرحله از بریج توکن سفارشی، راهنمای [بریج ERC20 از طریق Gateway سفارشی](/developers/guides/bridge-erc20-through-the-custom-gateway) را مشاهده کنید.

تمام قراردادهای Gateway پیام را فرموله کرده و به `L1ScrollMessenger` ارسال می‌کنند که می‌تواند پیام‌های دلخواه را به L2 ارسال کند. `L1ScrollMessenger` پیام را به `L1MessageQueue` منتقل می‌کند. هر کاربری می‌تواند پیام‌ها را مستقیماً به Messenger ارسال کند تا داده‌های دلخواه را در L2 اجرا کند. به این معنی که آنها می‌توانند هر تابعی را در L2 از طریق تراکنش‌های انجام شده در L1 از طریق پل اجرا کنند. اگرچه یک برنامه می‌تواند مستقیماً پیام‌ها را به قراردادهای توکن موجود منتقل کند، Gateway جزییات را انتزاع کرده و انتقالات و فراخوانی‌ها را ساده می‌کند.

<Aside type="tip" title="">
  در به‌روزرسانی‌های آینده، کاربران قادر خواهند بود `L1ScrollMessenger` را دور بزنند و پیام‌ها را مستقیماً به `L1MessageQueue` ارسال کنند. اگر پیامی از طریق `L1MessageQueue` ارسال شود، فرستنده تراکنش، آدرس کاربری است که تراکنش را ارسال کرده است، نه آدرس `L1ScrollMessenger`.
</Aside>

زمانی که بلوک جدیدی در L1 ایجاد می‌شود، Watcher پیام را در `L1MessageQueue` شناسایی کرده و آن را به سرویس Relayer منتقل می‌کند که تراکنش را به L2 از طریق گره l2geth ارسال می‌کند. در نهایت، گره l2geth تراکنش را به قرارداد `L2ScrollMessenger` برای اجرا در L2 منتقل می‌کند.

## برداشت ETH و توکن‌های ERC20 از L2

L2 Gateway بسیار شبیه به L1 Gateway است. ما می‌توانیم ETH و توکن‌های ERC20 را با استفاده از توابع `withdrawETH` و `withdrawERC20` به L1 برداشت کنیم. آدرس قرارداد بر روی L2 مستقر است. ما از `getL1ERC20Address` برای بازیابی آدرس توکن در L1 استفاده می‌کنیم.

<Aside type="tip" title="">
  **`withdrawETH`** و **`withdrawERC20`** توابع پرداختی هستند و مقدار ETH ارسال‌شده به این توابع برای پرداخت هزینه‌های L1 استفاده خواهد شد. اگر مقدار کافی نباشد، تراکنش ارسال نخواهد شد. تمام ETH اضافی به فرستنده برمی‌گردد. هزینه‌ها بستگی به فعالیت L1 دارد اما `0.005 ETH` باید برای پردازش برداشت توکن کافی باشد.
</Aside>

<Aside type="caution" title="">
  **مطمئن شوید که تراکنش‌ها در L1 بازنگردند** در حالی که از L2 ارسال می‌شود. هیچ راهی برای بازیابی ETH، توکن‌ها یا NFTهای بریج شده وجود ندارد اگر تراکنش شما در L1 بازگردد. تمام دارایی‌ها در Scroll هنگام ارسال تراکنش سوزانده می‌شوند و غیرممکن است دوباره آنها را ضرب کرد.
</Aside>

## ایجاد توکن ERC20 با منطق سفارشی در L2

اگر یک توکن نیاز به منطق خاص در L2 داشته باشد، باید از طریق `L1CustomERC20Gateway` و `L2CustomERC20Gateway` به ترتیب بریج شود. توکن سفارشی در L2 باید به Gateway اجازه دهد تا توکن‌های جدید را هنگام واریز و هنگام برداشت توکن‌ها بسوزاند.

رابط زیر `IScrollStandardERC20` است که برای استقرار توکن‌های سازگار با `L2CustomERC20Gateway` در L2 نیاز است.

```solidity
interface IScrollStandardERC20 {
  /// @notice آدرس Gateway متعلق به توکن را برمی‌گرداند.
  function gateway() external view returns (address);

  /// @notice آدرس توکن همتای توکن را برمی‌گرداند.
  function counterpart() external view returns (address);

  /// @dev استاندارد ERC677، به https://github.com/ethereum/EIPs/issues/677 مراجعه کنید
  /// دیفای می‌تواند از این روش برای انتقال توکن L1/L2 به L2/L1 استفاده کند،
  /// و واریز به قرارداد L2/L1 را در یک تراکنش انجام دهد
  function transferAndCall(address receiver, uint256 amount, bytes calldata data) external returns (bool success);

  /// @notice مقداری توکن به حساب گیرنده اضافه می‌کند.
  /// @dev ابزارهای Gateway، فقط قرارداد Gateway می‌تواند فراخوانی کند
  /// @param _to آدرس گیرنده.
  /// @param _amount مقدار توکن برای اضافه کردن.
  function mint(address _to, uint256 _amount) external;

  /// @notice مقداری توکن از حساب می‌سوزاند.
  /// @dev ابزارهای Gateway، فقط قرارداد Gateway می‌تواند فراخوانی کند
  /// @param _from آدرس حساب برای سوزاندن توکن.
  /// @param _amount مقدار توکن برای اضافه کردن.
  function burn(address _from, uint256 _amount) external;
}
```

### افزودن توکن ERC20 سفارشی به پل Scroll

توکن‌ها می‌توانند از طریق قراردادهای Gateway که توسط هر توسعه‌دهنده‌ای مستقر شده‌اند، به صورت امن و بدون مجوز بریج شوند. با این حال، Scroll همچنین یک روتر ERC20 و یک Gateway را مدیریت می‌کند که تمام توکن‌های ایجاد شده توسط جامعه را خوش‌آمد می‌گوید. عضویت در Gateway مدیریت شده Scroll به این معنی است که نیازی به استقرار قراردادهای Gateway نخواهید داشت و توکن شما در نمای جلویی Scroll ظاهر خواهد شد. برای عضویت در Gateway Scroll، باید با تیم Scroll تماس بگیرید تا توکن را به قراردادهای پل L1 و L2 اضافه کنید. برای این کار، دستورالعمل‌های موجود در مخزن [فهرست توکن‌ها](https://github.com/scroll-tech/token-list) را دنبال کنید تا توکن جدید خود را به نمای رسمی Scroll اضافه کنید.

## API Gateway L1

لطفاً برای مستندات کامل API قرارداد Scroll به [کتابخانه npm](https://www.npmjs.com/package/@scroll-tech/contracts?activeTab=code) مراجعه کنید.

### depositETH

```solidity
function depositETH(address _to, uint256 _amount, uint256 _gasLimit) public payable;
```

ETH را از L

1 به L2 ارسال می‌کند.

| پارامتر | توضیحات                                                                                                                     |
| ------- | --------------------------------------------------------------------------------------------------------------------------- |
| to      | آدرس حساب گیرنده در L2.                                                                                                     |
| amount  | مقدار توکن برای انتقال، به واحد wei.                                                                                       |
| gasLimit| محدودیت گس مورد نیاز برای تکمیل واریز در L2. 170000 باید برای پردازش تراکنش کافی باشد، اما وجوه استفاده نشده برگردانده می‌شود. |

### depositERC20

```solidity
function depositERC20(address _token, address _to, uint256 _amount, uint256 _gasLimit) payable;
```

توکن‌های ERC20 را از L1 به L2 ارسال می‌کند.

| پارامتر | توضیحات                                                                                                                     |
| ------- | --------------------------------------------------------------------------------------------------------------------------- |
| token   | آدرس توکن در L1.                                                                                                            |
| to      | آدرس حساب گیرنده در L2.                                                                                                     |
| amount  | مقدار توکن برای انتقال، به واحد wei.                                                                                       |
| gasLimit| محدودیت گس مورد نیاز برای تکمیل واریز در L2. 200000 باید برای پردازش تراکنش کافی باشد، بسته به Gateway، اما وجوه استفاده نشده برگردانده می‌شود. |

### getL2ERC20Address

```solidity
function getL2ERC20Address(address _l1Token) external view returns (address);
```

آدرس توکن مربوطه در L2 را با توجه به آدرس توکن در L1 برمی‌گرداند.

| پارامتر | توضیحات              |
| ------- | -------------------- |
| \_l1Token | آدرس توکن L1.       |

### updateTokenMapping

```solidity
function updateTokenMapping(address _l1Token, address _l2Token) external;
```

نگاشت توکن ERC20 از L1 به L2 را به‌روزرسانی می‌کند.

| پارامتر | توضیحات                                   |
| ------- | ----------------------------------------- |
| \_l1Token | آدرس توکن ERC20 در L1.                    |
| \_l2Token | آدرس توکن مربوطه در L2.                   |

## API Gateway L2

### withdrawETH

```solidity
function withdrawETH(address to, uint256 amount, uint256 gasLimit) external payable;
```

ETH را از L2 به L1 ارسال می‌کند.

| پارامتر | توضیحات                                                                                             |
| ------- | --------------------------------------------------------------------------------------------------- |
| to      | آدرس حساب گیرنده در L1.                                                                            |
| amount  | مقدار توکن برای انتقال، به واحد wei.                                                              |
| gasLimit| محدودیت گس مورد نیاز برای تکمیل واریز در L1. این اختیاری است، اگر نمی‌خواهید آن را تنظیم کنید، مقدار 0 ارسال کنید. |

### withdrawERC20

```solidity
function withdrawERC20(address token, address to, uint256 amount, uint256 gasLimit) external payable;
```

توکن‌های ERC20 را از L2 به L1 ارسال می‌کند.

| پارامتر | توضیحات                                                                                             |
| ------- | --------------------------------------------------------------------------------------------------- |
| token   | آدرس توکن در L2.                                                                                  |
| to      | آدرس حساب گیرنده در L1.                                                                            |
| amount  | مقدار توکن برای انتقال، به واحد wei.                                                              |
| gasLimit| محدودیت گس مورد نیاز برای تکمیل واریز در L1. این اختیاری است، اگر نمی‌خواهید آن را تنظیم کنید، مقدار 0 ارسال کنید. |

### getL1ERC20Address

```solidity
function getL1ERC20Address(address l2Token) external view returns (address);
```

آدرس توکن مربوطه در L1 را با توجه به آدرس توکن در L2 برمی‌گرداند.

| پارامتر | توضیحات                  |
| ------- | ------------------------ |
| l2Token | آدرس توکن L2.            |

### updateTokenMapping

```solidity
function updateTokenMapping(address _l1Token, address _l2Token) external;
```

نگاشت توکن ERC20 از L2 به L1 را به‌روزرسانی می‌کند.

| پارامتر | توضیحات                                   |
| ------- | ----------------------------------------- |
| \_l2Token | آدرس توکن ERC20 در L2.                    |
| \_l1Token | آدرس توکن مربوطه در L1.                   |
