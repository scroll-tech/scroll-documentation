---
section: developers
date: Last Modified
title: "تفاوت‌های Ethereum و Scroll"
lang: "fa"
permalink: "developers/ethereum-and-scroll-differences"
whatsnext: { "بریج L1 و L2": "/fa/developers/l1-and-l2-bridging/" }
excerpt: "تعدادی از جزئیات فنی بین EVM اصلی Ethereum و طراحی اصلاح‌شده Scroll برای zkEVM متفاوت است. در زیر می‌توانید این تفاوت‌ها را همان‌طور که در حال حاضر وجود دارند، مشاهده کنید."
---

import Aside from "../../../../components/Aside.astro"

تعدادی از جزئیات فنی بین EVM اصلی Ethereum و طراحی اصلاح‌شده Scroll برای zkEVM متفاوت است. در زیر می‌توانید این تفاوت‌ها را همان‌طور که در حال حاضر وجود دارند، مشاهده کنید.

برای مشارکت‌کنندگان متن‌باز و سازندگان زیرساخت، لطفاً با تیم ما برای دریافت پشتیبانی بیشتر تماس بگیرید.

<Aside type="tip" title="نگران نباشید!">
برای توسعه‌دهنده‌های معمولی Solidity، این جزئیات بر تجربه توسعه شما تأثیر نخواهد گذاشت.
</Aside>

## کدهای عملیات EVM

| کد عملیات                    | معادل Solidity       | رفتار Scroll                                                                                         |
| ----------------------------- | --------------------- | ----------------------------------------------------------------------------------------------------- |
| `BLOCKHASH`                   | `block.blockhash`     | مقدار `keccak(chain_id \|\| block_number)` را برای آخرین ۲۵۶ بلوک بازمی‌گرداند.                     |
| `COINBASE`                    | `block.coinbase`      | آدرس قرارداد کیف پول هزینه از پیش مستقر شده را برمی‌گرداند. به [قراردادهای Scroll](/developers/scroll-contracts) مراجعه کنید. |
| `DIFFICULTY` / `PREVRANDAO`   | `block.difficulty`    | مقدار ۰ را برمی‌گرداند.                                                                              |
| `SELFDESTRUCT`                | `selfdestruct`        | غیرفعال شده است. اگر کد عملیات مشاهده شود، تراکنش برگردانده خواهد شد.[^willadpot]                  |

<Aside type="caution" title="">
کدهای عملیات مربوط به EIP-4844، مانند `BLOBHASH` و `BLOBBASEFEE`، هنوز در Scroll در دسترس نیستند. علاوه بر این، [EIP-4788](https://eips.ethereum.org/EIPS/eip-4788) برای دسترسی به ریشه بلوک Beacon Chain پشتیبانی نمی‌شود.
</Aside>

ما از هدف EVM `cancun` و آخرین نسخه Solidity `0.8.26` پشتیبانی می‌کنیم.

[^willadpot]: در آینده برای پذیرش راه‌حل Ethereum تغییر خواهد کرد.

## پیش‌کامپایل‌های EVM

پیش‌کامپایل‌های `RIPEMD-160` (آدرس `0x3`)، `blake2f` (آدرس `0x9`) و `point evaluation` (آدرس `0x0a`) در حال حاضر پشتیبانی نمی‌شوند. تماس‌ها با قراردادهای پیش‌کامپایل نشده برمی‌گردند. ما قصد داریم این پیش‌کامپایل‌ها را در هاردفورک‌های آینده فعال کنیم.

پیش‌کامپایل `modexp` پشتیبانی می‌شود اما تنها ورودی‌های با اندازه کمتر یا مساوی ۳۲ بایت (یعنی `u256`) را پشتیبانی می‌کند.

پیش‌کامپایل `ecPairing` پشتیبانی می‌شود، اما تعداد نقاط (مجموعه‌ها، جفت‌ها) به ۴ محدود است، به جای ۶.

سایر پیش‌کامپایل‌های EVM کاملاً پشتیبانی می‌شوند: `ecRecover`، `identity`، `ecAdd`، `ecMul`.

### محدودیت‌های پیش‌کامپایل

به دلیل اندازه محدود مدارهای zkEVM، یک حد بالایی برای تعداد تماس‌هایی که می‌توان برای برخی پیش‌کامپایل‌ها انجام داد وجود دارد. این تراکنش‌ها برنخواهند گشت، اما اگر نتوانند در فضای مدار جا شوند، توسط Sequencer نادیده گرفته خواهند شد. درباره [Circuit Capacity Checker](/en/technology/sequencer/execution-node#circuit-capacity-checker) بیشتر بخوانید.

| پیش‌کامپایل / کد عملیات | محدودیت | 
| ----------------------- | ------- |
| `keccak256`             | 3157    |
| `ecRecover`             | 119     |
| `modexp`                | 23      |
| `ecAdd`                 | 50      |
| `ecMul`                 | 50      |
| `ecPairing`             | 2       |
{/* TODO: Add SHA256 after upgrade */}


## حساب حالت

### **فیلدهای اضافی**

ما دو فیلد اضافی در شیء `StateAccount` کنونی اضافه کرده‌ایم: `PoseidonCodehash` و `CodeSize`.

```go
type StateAccount struct {
	Nonce    uint64
	Balance  *big.Int
	Root     common.Hash // ریشه مرکل از trie ذخیره‌سازی
	KeccakCodeHash []byte // هنوز هش کد Keccak
	// فیلدهای اضافه شده
	PoseidonCodeHash []byte // هش کد Poseidon
	CodeSize uint64
}
```

### **کد هش**

در این رابطه، ما دو نوع کد هش برای هر بایت‌کد قرارداد نگهداری می‌کنیم: هش Keccak و هش Poseidon.

`KeccakCodeHash` برای حفظ سازگاری با `EXTCODEHASH` نگهداری می‌شود. `PoseidonCodeHash` برای تأیید صحت بایت‌کدهای بارگذاری شده در zkEVM استفاده می‌شود، جایی که هش Poseidon بسیار کارآمدتر است.

### اندازه کد

هنگام تأیید `EXTCODESIZE`، بارگذاری تمام داده‌های قرارداد به zkEVM پرهزینه است. در عوض، اندازه قرارداد در زمان ایجاد قرارداد در ذخیره‌سازی ذخیره می‌شود. به این ترتیب، نیازی به بارگذاری کد نیست — یک اثبات ذخیره‌سازی برای تأیید این کد عملیات کافی است.

## زمان بلوک

برای بهبود توان عملیاتی زنجیره Scroll، ما زمان بلوک دینامیک را در [ارتقاء Curie](/technology/overview/scroll-upgrades#curie-upgrade) معرفی کردیم. در طول دوره‌های شلوغی، بلوک زمانی مهر و موم می‌شود که تراکنش‌های موجود در بلوک به حد مدار برسند به جای انتظار برای فاصله زمانی ۳ ثانیه. در ساعات عادی، بلوک‌ها هنوز هم در فاصله زمانی ۳ ثانیه مهر و موم خواهند شد تا تجربه کاربری ثابتی را تضمین کنند.

## ترتیب تراکنش‌ها

مشابه Ethereum، Sequencer در Scroll سعی می‌کند تراکنش‌های قابل اجرا را بر اساس "tip" (هزینه اولویت) آنها اولویت‌بندی کند. در اکثر موارد، تراکنش‌ها در بلوک بعدی به ترتیب نزولی tips آن‌ها گنجانده خواهند شد.

با این حال، مشابه Ethereum، این ترتیب توسط پروتکل تضمین نشده است و برخی بلوک‌ها ممکن است از آن منحرف شوند. به ویژه، در دوره‌های کم ازدحام mempool، Sequencer تراکنش‌ها را بر اساس ترتیب ورود به بلوک پردازش خواهد کرد، بنابراین برخی تراکنش‌ها ممکن است قبل از تراکنش‌های با tip بالاتر در همان بلوک قرار گیرند.

## EIP‌های آینده

ما به دقت بر روی تمامی EIP‌های در حال ظهور که توسط Ethereum پذیرفته شده‌اند نظارت می‌کنیم و آنها را در صورت مناسب بودن به‌کار می‌بریم. اگر به جزئیات بیشتری علاقه‌مندید، در [انجمن جامعه ما](https://community.scroll.io) یا در [Discord Scroll](https://discord.gg/scroll) با ما تماس بگیرید.

## هزینه‌های تراکنش

هزینه‌ای که به تراکنش‌های Scroll تعلق می‌گیرد شامل دو بخش است:

- **هزینه گس L2:** مشابه L1، مقدار هزینه اجرای L2 برابر است با `L2_gas_price * L2_gas_used` که شامل هزینه‌های زیر است:
  - هزینه اجرای Sequencer L2 و هزینه ذخیره‌سازی
  - هزینه تأیید و نهایی‌سازی اعتبار در L1
  - هزینه اثبات‌کننده
- **هزینه داده L1:** هزینه اضافی بر روی هزینه گس L2. هزینه داده L1 فقط برای تراکنش‌های آغاز شده از L2، نه برای تراکنش‌های آغاز شده از L1، دریافت می‌شود. این هزینه به هزینه ارسال داده به L1 برای در دسترس بودن داده‌ها مربوط می‌شود. به دلیل اینکه ما داده‌های تراکنش را به L1 منتقل می‌کنیم، هزینه رول‌آپ L1 بر اساس اندازه داده‌های تراکنش محاسبه می‌شود.

برای اطلاعات بیشتر، به [هزینه‌های تراکنش در Scroll](/developers/transaction-fees-on-scroll) مراجعه کنید.

---